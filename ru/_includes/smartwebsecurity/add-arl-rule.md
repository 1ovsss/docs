1. Введите имя правила.
1. (опционально) Введите описание.
1. Задайте приоритет правила. Этот приоритет действует только на правила ARL и не зависит от приоритета правил в профиле безопасности.
1. (опционально) Включите опцию **Только логирование (Dry run)**, чтобы протестировать правило и оценить нагрузку на веб-сервис. В этом режиме запросы блокироваться не будут.

1. В блоке **Условия на трафик** выберите **Весь трафик** или **При условии**.
1. Чтобы задать [условия на трафик](../../smartwebsecurity/concepts/conditions.md), в списке **Условия** выберите один или несколько пунктов:
    *  `IP` — IP-адрес, диапазон адресов или регион IP-адресов;
    *  `HTTP header` — строка в заголовке HTTP;
    *  `HTTP body` — строка в теле HTTP-пакета;
    *  `Request path` — путь запроса;
    *  `Host` — домен, на который пришел запрос.
    *  `HTTP method` — метод запроса;
    *  `Cookie` — строка в заголовке cookie. 

        Вы можете задать несколько условий одного типа. Для разных типов условий действуют разные логические операторы: _и_ или _или_. Чтобы добавить более одного условия определенного типа нажмите кнопки ![plus-sign](../../_assets/console-icons/plus.svg) **{{ ui-key.yacloud.component.condition-column.condition_and }}** или ![plus-sign](../../_assets/console-icons/plus.svg) **{{ ui-key.yacloud.component.condition-column.condition_or }}**.

        Чтобы удалить условие, нажмите кнопку ![options](../../_assets/console-icons/trash-bin.svg).
  
1. В блоке **Подсчет запросов** выберите:
     * **Без группировки** — считать каждый запрос в отдельности;
     * **По характеристикам** — считать группы запросов, объединенных одной или несколькими характеристиками.

        1. Выберите характеристику для группировки:

            Автоматическая группировка | Группировка по ключу
            ---|---
            `Request path` — путь запроса | `HTTP cookie` —  строка в заголовке cookie
            `HTTP method` — метод запроса | `HTTP header` — строка в заголовке HTTP
            `IP-адрес` — IP-адрес, с которого пришел запрос | `Query params` — строка в параметрах запроса.
            `Регион` — регион, которому принадлежат IP-адреса запросов |
            `Host` — домен, на который пришел запрос |
            
            Для группировки по ключу, укажите его значение.
            
        1. (Опционально) Включите опцию **Учитывать регистр**, чтобы характеристики с одинаковыми значениями, но в разном регистре попадали в разные группы.

1. Укажите лимит запросов или групп запросов. Все запросы свыше лимита будут блокироваться. 
1. Выберите промежуток времени (от `1 секунды` до `60 минут`), за который считать лимит.
1. Нажмите кнопку **Сохранить правило**.