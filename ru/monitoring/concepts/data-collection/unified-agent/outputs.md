# Выходы

Выход можно описать в секции `routes` внутри элемента `channel`:`output`. Либо в секции именованных каналов `channels`.

Общий формат описания выхода:

```yaml
- output:
    plugin: ... # имя плагина
    id: ... # (рекомендуемый) идентификатор выхода, используется в метриках и логах работы агента
```

## Выход debug {#debug_output}

Отладочный выход — выводит поступающие сообщения в файл или в консоль.

Так как хранилище не поддерживает локальный просмотр данных, вы можете настроить выгрузку данных в файл через этот выход. Ротацию можно настроить через утилиту `logrotate`. Чтобы агент начал записывать логи в новый файл, воспользуйтесь методом `reopen_file`. 

Пример конфигурации:

```yaml
status:
  port: 16301

output:
  plugin: debug
  id: my_output_id
  config:
    file_name: ./data/output
    delimiter: "\n===\n"
    _test:
      register_test_handlers: true
```

Описание параметров:

```yaml
- channel:
    output:
        plugin: debug
        config:
            # Должно быть указано одно из свойств file_name или directory.

            # Имя файла, в который будут записываться сообщения.
            # Для вывода в консоль укажите значение "/dev/stdout".
            file_name: out.txt  # необязательный, по умолчанию не задан

            # Имя директории. Если указано, данные каждой сессии будут записываться в отдельный файл в этой директории с именем, равным идентификатору сессии.
            directory: output_directory  # необязательный, по умолчанию не задан

            # Разделитель сообщений в файле, например "\n".
            delimiter: null  # обязательный
```

## Выход dev_null {#dev_null_output}

Отладочный «пустой» выход — не сохраняет поступающие сообщения. Параметров нет.

## Выход yc_metrics {#yc_metrics_output}

Выход для записи метрик в {{ monitoring-full-name }} API.

Описание параметров:

```yaml
- channel:
    output:
        plugin: yc_metrics
        config:
        # URL, на который будут отправляться метрики.
        url: https://monitoring.{{ api-host }}/monitoring/v2/data/write  # необязательный, по умолчанию https://monitoring.{{ api-host }}/monitoring/v2/data/write

        folder_id: b1ge2vt0gml6********  # обязательный, идентификатор каталога

        # Настройки IAM-аутентификации.
        iam:  # обязательный
            # Должен быть указан один из элементов cloud_meta или jwt.

            # Если указан, IAM-токен берется из сервиса метаданных.
            cloud_meta: {}  #необязательный, по умолчанию не задан

            # Если указан, JWT обменивается на IAM-токен.
            jwt:  #необязательный, по умолчанию не задан
            # Имя файла с параметрами JWT в формате, который возвращает команда `yc iam key create`.
                file: "jwt_params.json"  # обязательный

                endpoint: iam.{{ api-host }}  # необязательный, по умолчанию iam.{{ api-host }}

                refresh_period: 1h  # необязательный, по умолчанию 1h

                request_timeout: 10s  # необязательный, по умолчанию 10s

        # Число повторных попыток, если запрос завершился с ошибкой.
        # Если за указанное число запрос так и не был выполнен успешно (то есть не был получен ответ со статусом 200), сообщение отбрасывается, то есть по нему формируется подтверждение в сторону агента.
        # Отброшенные таким образом сообщения учитываются в счетчике DroppedMessages этого плагина, а также отображаются в общих health-счетчиках MessagesLost и BytesLost.
        retry_count: inf  # необязательный, по умолчанию max_int, то есть сообщения отбрасываться не будут

        # Задержка между повторными попытками.
        retry_delay: 1s  # необязательный, по умолчанию 1 секунда

        # Таймаут запроса, включая все повторные попытки.
        timeout: inf  # необязательный, по умолчанию max_int секунд, то есть сообщения отбрасываться не будут

        # Таймаут на одну попытку.
        request_timeout: 1s  # необязательный, по умолчанию одна секунда
```



## Выход yc_logs {#yc_logs_output}

Выход для отправки метрик в {{ cloud-logging-full-name }} по протоколу [grpc](../../../../logging/api-ref/grpc/log_ingestion_service.md).

{% note info %}

Агент старается не допускать дубликатов сообщений в целевой системе, но не гарантирует, что их не будет. Дубликаты могут возникать при остановке и повторном запуске.

{% endnote %}

Описание параметров:

```yaml
- channel:
    output:
        plugin: yc_logs
        config:
        # URL, на который будут отправляться метрики.
        url: https://monitoring.{{ api-host }}/monitoring/v2/data/write  # необязательный, по умолчанию https://monitoring.{{ api-host }}/monitoring/v2/data/write

        folder_id: b1ge2vt0gml6********  # обязательный, идентификатор каталога

        # Настройки IAM-аутентификации.
        iam:  # обязательный
            # Должен быть указан один из элементов cloud_meta или jwt.

            # Если указан, IAM-токен берется из сервиса метаданных.
            cloud_meta: {}  #необязательный, по умолчанию не задан

            # Если указан, JWT обменивается на IAM-токен.
            jwt:  #необязательный, по умолчанию не задан
            # Имя файла с параметрами JWT в формате, который возвращает команда `yc iam key create`.
                file: "jwt_params.json"  # обязательный

                endpoint: iam.{{ api-host }}  # необязательный, по умолчанию iam.{{ api-host }}

                refresh_period: 1h  # необязательный, по умолчанию 1h

                request_timeout: 10s  # необязательный, по умолчанию 10s

        # Число повторных попыток, если запрос завершился с ошибкой.
        # Если за указанное число запрос не был выполнен успешно (не получен ответ со статусом 200), сообщение отбрасывается. По этому сообщению формируется подтверждение в сторону агента
        # Отброшенные таким образом сообщения учитываются в счетчике DroppedMessages этого плагина, а также отображаются в общих health-счетчиках MessagesLost и BytesLost.
        retry_count: inf  # необязательный, по умолчанию max_int, то есть сообщения отбрасываться не будут

        # Задержка между повторными попытками.
        retry_delay: 1s  # необязательный, по умолчанию 1 секунда

        # Таймаут запроса, включая все повторные попытки.
        timeout: inf  # необязательный, по умолчанию max_int секунд, то есть сообщения отбрасываться не будут

        # Таймаут на одну попытку.
        request_timeout: 1s  # необязательный, по умолчанию одна секунда
```

