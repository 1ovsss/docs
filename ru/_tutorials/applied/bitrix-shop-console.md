1. [Подготовьте облако к работе](#before-you-begin).
1. [Создайте ВМ в облаке](#create-vm).
1. [Создайте кластер БД {{ MY }}](#create-mysql).
1. [Настройте ВМ для работы с «1C-Битрикс»](#configure-server).
1. [Настройте «1С-Битрикс»](#configure-bitrix).

Если созданные ресурсы вам больше не нужны, [удалите их](#clear-out).

## Подготовьте облако к работе {#before-you-begin}

{% include [before-you-begin](../_tutorials_includes/before-you-begin.md) %}

### Необходимые платные ресурсы {#paid-resources}

{% include [bitrix-shop-paid-resources](../_tutorials_includes/bitrix-shop-paid-resources.md) %}

## Создайте ВМ в облаке {#create-vm}

{% list tabs %}

- Консоль управления

  1. На странице каталога в [консоли управления]({{ link-console-main }}) нажмите кнопку **Создать ресурс** и выберите пункт **Виртуальная машина**.
  1. В поле **Имя** введите имя виртуальной машины, например `bitrix`.

     {% include [name-format](../../_includes/name-format.md) %}

  1. Выберите [зону доступности](../../overview/concepts/geo-scope.md), в которой должна находиться виртуальная машина. Если вы не знаете, какая зона доступности вам нужна, оставьте выбранную по умолчанию.
  1. В блоке **Выбор образа/загрузочного диска** перейдите на вкладку **{{ marketplace-name }}** и выберите образ операционной системы [Ubuntu 18.04 lts](/marketplace/products/yc/ubuntu-18-04-lts).
  1. В блоке **Диски** выберите диск SSD размером 13 ГБ.
  1. В блоке **Вычислительные ресурсы** укажите конфигурацию, которая необходима для корректной работы «1С-Битрикс»:
     * **Платформа** — `Intel Ice Lake`.
     * **Гарантированная доля vCPU** — `20%`.
     * **vCPU** — `2`.
     * **RAM** — `4 ГБ`.

  1. В блоке **Сетевые настройки**:
     * Выберите **Сеть** и **Подсеть**, к которым нужно подключить виртуальную машину. Если нужной сети или подсети еще нет, создайте их в этом же блоке.
     * В поле **Публичный адрес** оставьте значение `Автоматически`, чтобы назначить виртуальной машине случайный внешний IP-адрес из пула {{ yandex-cloud }}, или выберите статический адрес из списка, если вы зарезервировали его заранее.

  1. В блоке **Доступ** укажите данные для доступа к виртуальной машине:
     * В поле **Логин** введите имя для пользователя, который будет создан на виртуальной машине, например `ubuntu`.
     * В поле **SSH-ключ** скопируйте значение вашего открытого SSH-ключа. Пару ключей для подключения по [SSH](../../glossary/ssh-keygen.md) необходимо [создать самостоятельно](../../compute/operations/vm-connect/ssh.md).

  1. Нажмите кнопку **Создать ВМ**.

{% endlist %}

## Создайте кластер БД {{ MY }} {#create-mysql}

{% list tabs %}

- Консоль управления

  1. На странице каталога в [консоли управления]({{ link-console-main }}) нажмите кнопку **Создать ресурс** и выберите пункт **Кластер MySQL**.
  1. В поле **Имя** введите имя виртуальной машины, например `bitrix-mysql`.

     {% include [name-format](../../_includes/name-format.md) %}

  1. В блоке **Класс Хоста** выберите **Тип** хоста `s2.micro`.
  1. В блоке **База данных** укажите:
     * **Имя БД**. Оставьте значение по умолчанию `db1`.
     * **Имя пользователя**, которое является логином для подключения к базе данных. Оставьте значение по умолчанию `user1`.
     * **Пароль**, который нужен будет «1С-Битрикс» для доступа к базе данных.

  1. В блоке **Хосты**, при необходимости, поменяйте **Зону доступности**, в которой должен находиться хост. Для этого нажмите значок ![pencil](../../_assets/console-icons/pencil.svg) в строке хоста и выберите нужную зону в открывшемся окне.

     Рекомендуется выбрать ту же **Зону доступности**, которую вы выбрали при создании виртуальной машины. Это позволит уменьшить задержку (latency) между виртуальной машиной и базой данных.

     Чтобы база данных была отказоустойчивой, вы можете добавить дополнительные хосты к кластеру. Для этого нажмите кнопку **Добавить хост**, выберите зону доступности и подсеть, затем нажмите кнопку **Сохранить**.
  1. Убедитесь, что для хостов кластера не запрошен публичный доступ: с этой настройкой «1С-Битрикс» не сможет подключиться к кластеру.
  1. Остальные поля оставьте без изменений.
  1. Нажмите кнопку **Создать кластер**.

  Создание кластера БД может занять несколько минут.

{% endlist %}

## Настройте ВМ для работы с «1C-Битрикс» {#configure-server}

{% include [bitrix-shop-configure-server](../_tutorials_includes/bitrix-shop-configure-server.md) %}

## Настройте «1С-Битрикс» {#configure-bitrix}

{% include [bitrix-shop-configure-bitrix](../_tutorials_includes/bitrix-shop-configure-bitrix.md) %}

## Как удалить созданные ресурсы {#clear-out}

Чтобы перестать платить за созданные ресурсы:
1. [Удалите](../../compute/operations/vm-control/vm-delete.md) ВМ `bitrix`.
1. [Удалите](../../managed-mysql/operations/cluster-delete.md) кластер {{ MY }} `bitrix-mysql`.

Если вы зарезервировали статический публичный IP-адрес специально для этой ВМ:
1. Выберите сервис **{{ vpc-name }}** в вашем каталоге.
1. Перейдите на вкладку **IP-адреса**.
1. Найдите нужный адрес, нажмите значок ![ellipsis](../../_assets/console-icons/ellipsis.svg) и выберите пункт **Удалить**.